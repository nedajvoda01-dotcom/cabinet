# Result Profiles Policy
# Defines field filtering and size limits per UI profile

version: v1.0.0

profiles:
  # Internal/Admin UI - Full access
  internal_ui:
    name: "Internal Admin UI"
    description: "Full administrative access with all fields visible"
    max_response_size_bytes: 10485760  # 10MB
    max_array_length: 5000
    max_string_length: 1000000
    truncate_on_overflow: false
    
    allowed_fields:
      listing:
        - id
        - brand
        - model
        - year
        - price
        - status
        - vin
        - owner_id
        - owner_name
        - owner_email
        - owner_phone
        - internal_notes
        - cost_price
        - profit_margin
        - created_at
        - updated_at
        - created_by
        - updated_by
      
      user:
        - id
        - name
        - email
        - phone
        - role
        - created_at
        - last_login
        - ip_address
      
      import:
        - import_id
        - filename
        - status
        - records_count
        - errors_count
        - started_at
        - finished_at
        - error_message
        - content_hash
        - started_by
  
  # Public UI - Limited access
  public_ui:
    name: "Public UI"
    description: "Customer-facing interface with limited field visibility"
    max_response_size_bytes: 1048576  # 1MB
    max_array_length: 100
    max_string_length: 10000
    truncate_on_overflow: false
    
    allowed_fields:
      listing:
        - id
        - brand
        - model
        - year
        - price
        - status
      
      user:
        - id
        - name
      
      import:
        - import_id
        - status
  
  # Operations UI - Operational fields
  ops_ui:
    name: "Operations UI"
    description: "Operations team interface with operational fields"
    max_response_size_bytes: 5242880  # 5MB
    max_array_length: 1000
    max_string_length: 100000
    truncate_on_overflow: false
    
    allowed_fields:
      listing:
        - id
        - brand
        - model
        - year
        - price
        - status
        - vin
        - owner_id
        - owner_name
        - created_at
        - updated_at
      
      user:
        - id
        - name
        - email
        - role
        - created_at
      
      import:
        - import_id
        - filename
        - status
        - records_count
        - errors_count
        - started_at
        - finished_at

# UI to Profile Mapping
ui_profiles:
  admin: internal_ui
  internal: internal_ui
  main_ui: internal_ui
  public: public_ui
  operations: ops_ui

# Redaction rules
redaction:
  # Fields to always redact in logs/audit
  sensitive_fields:
    - password
    - secret
    - token
    - api_key
    - credit_card
    - ssn
    - private_key
  
  # Redaction marker
  redacted_marker: "[REDACTED]"
  
  # Hash sensitive IDs in public responses
  hash_ids_for_public: true
