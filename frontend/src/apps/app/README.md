# App architecture: one app, access via permissions

## –ü—Ä–∏–Ω—Ü–∏–ø
–í –ø—Ä–æ–µ–∫—Ç–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç **–æ–¥–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (one app)** –∏ **–æ–¥–∏–Ω UI-–¥–∏–∑–∞–π–Ω** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (superadmin / admin / member)  
—Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ permissions**, –∞ –Ω–µ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è,
–æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞–Ω–µ–ª–∏ –∏–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ä–æ—É—Ç—ã.

‚ùå –ù–ï–¢:
- –æ—Ç–¥–µ–ª—å–Ω—ã—Ö ‚Äú–∞–¥–º–∏–Ω—Å–∫–∏—Ö‚Äù –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –æ—Ç–¥–µ–ª—å–Ω—ã—Ö ‚Äú–æ–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–∏—Ö‚Äù –ø–∞–Ω–µ–ª–µ–π
- —Ä–∞–∑–Ω—ã—Ö layout‚Äô–æ–≤ –ø–æ–¥ —Ä–æ–ª–∏

‚úÖ –ï–°–¢–¨:
- –æ–¥–∏–Ω AppShell
- –æ–¥–∏–Ω –Ω–∞–±–æ—Ä routes
- –æ–¥–∏–Ω –Ω–∞–±–æ—Ä UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –ø–æ permissions

---

## –†–æ–ª–∏
–†–æ–ª–∏ ‚Äî —ç—Ç–æ **–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤**, –∞ –Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ UI.

–ë–∞–∑–æ–≤—ã–µ —Ä–æ–ª–∏:
- `superadmin` ‚Äî –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ –∏ —Ä–æ–ª—è–º–∏
- `admin` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–æ–π –∏ —Ä–∞–±–æ—á–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- `member` ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–º–∞–Ω–¥—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º

–†–æ–ª—å **–Ω–∏–∫–æ–≥–¥–∞ –Ω–∞–ø—Ä—è–º—É—é –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è UI**.  
UI –≤—Å–µ–≥–¥–∞ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ permissions.

---

## Permissions (–∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã)
–í—Å–µ —Ä–µ—à–µ–Ω–∏—è –æ –¥–æ—Å—Ç—É–ø–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ permissions:

- –¥–æ—Å—Ç—É–ø –∫ —Ä–æ—É—Ç–∞–º
- –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é
- –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π (–∫–Ω–æ–ø–∫–∏, —Ñ–æ—Ä–º—ã, –º–æ–¥–∞–ª–∫–∏)

–ü—Ä–∏–º–µ—Ä—ã:
- `admin.requests.view`
- `admin.requests.approve`
- `team.invite`
- `analytics.view`

–†–æ–ª–∏ ‚Üí permissions –º–∞–ø–ø—è—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ (–≤ shared/rbac).

---

## –ù–∞–≤–∏–≥–∞—Ü–∏—è
–ù–∞–≤–∏–≥–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ.

–ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –º–µ–Ω—é:
- –∏–º–µ–µ—Ç route
- –∏–º–µ–µ—Ç requiredPermissions
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω

–ù–∞–≤–∏–≥–∞—Ü–∏—è **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ if (role === ‚Ä¶)**.

---

## –†–æ—É—Ç–∏–Ω–≥
- –í—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –æ–±—ä—è–≤–ª—è—é—Ç—Å—è –≤ `app/routes.tsx`
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–º—ã—Å–ª—É –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `sections/*`
- –ö–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç –º–æ–∂–µ—Ç –∏–º–µ—Ç—å `requiredPermissions`

–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç:
- –ª–∏–±–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –º–µ–Ω—é
- –ª–∏–±–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –Ω–∞ `ForbiddenPage (403)`

---

## Sections
`sections/*` ‚Äî —ç—Ç–æ **–ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —ç–∫—Ä–∞–Ω–æ–≤**, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä:
- `sections/operator` ‚Äî —Ä–∞–±–æ—á–∏–µ —ç–∫—Ä–∞–Ω—ã
- `sections/admin` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- `sections/superadmin` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã (approve –∞–¥–º–∏–Ω–æ–≤)

Sections **–Ω–µ –∏–º–µ—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ AppShell** –∏ **–Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç layout**.

---

## Auth –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ **–Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω–æ–π**.

- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å **–∑–∞—è–≤–∫—É –Ω–∞ –¥–æ—Å—Ç—É–ø**
- –∑–∞—è–≤–∫–∞ –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å—ã: `pending / approved / rejected`
- —Ç–æ–ª—å–∫–æ `superadmin` –º–æ–∂–µ—Ç approve / reject –∑–∞—è–≤–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

–î–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é.

---

## –ó–∞–ø—Ä–µ—â–µ–Ω–æ
üö´ –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–¥ —Ä–æ–ª–∏ (`apps/admin`, `apps/operator`, –∏ —Ç.–ø.)  
üö´ –î–µ–ª–∞—Ç—å —Ä–∞–∑–Ω—ã–µ layout‚Äô—ã –ø–æ–¥ —Ä–æ–ª–∏  
üö´ –£–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–æ–º —á–µ—Ä–µ–∑ `if (role === ...)`  
üö´ –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Ä–∞–Ω—ã –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Ä–æ–ª–∏  

---

## –†–∞–∑—Ä–µ—à–µ–Ω–æ
‚úÖ –û–¥–∏–Ω app  
‚úÖ –û–¥–∏–Ω UI  
‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ permissions  
‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã  

---

## –¶–µ–ª—å
–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –Ω–∞—Ä–∞—â–∏–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- –ø–æ–¥–∫–ª—é—á–∞—Ç—å backend –ø–æ—ç—Ç–∞–ø–Ω–æ
- –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è UI
- –∏–∑–±–µ–≥–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –¥–æ–ª–≥–∞
